<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 from src/site/xdoc/getting-started.xml.vm at 10 March 2020
 | Rendered using Apache Maven Fluido Skin 1.7
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="The MyBatis Team" />
    <meta name="Date-Revision-yyyymmdd" content="20200310" />
    <meta http-equiv="Content-Language" content="en" />
    <title>mybatis-guice &#x2013; MyBatis Guice | Getting started</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.7.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script type="text/javascript" src="./js/apache-maven-fluido-1.7.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><div id="bannerLeft"><h2>mybatis-guice</h2>
</div>
</div>
        <div class="pull-right"><a href="http://www.mybatis.org/" id="bannerRight" title="MyBatis logo"><img src="http://www.mybatis.org/images/mybatis-logo.png"  alt="MyBatis logo"/></a></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="publishDate">Last Published: 10 March 2020<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 3.12</li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
    <ul class="nav nav-list">
      <li class="nav-header">Reference Documentation</li>
    <li><a href="index.html" title="Introduction"><span class="none"></span>Introduction</a></li>
    <li class="active"><a href="#"><span class="none"></span>Getting Started</a></li>
    <li><a href="core.html" title="Core components"><span class="none"></span>Core components</a></li>
    <li><a href="datasources.html" title="Data Sources"><span class="icon-chevron-down"></span>Data Sources</a>
    <ul class="nav nav-list">
    <li><a href="datasources/builtin.html" title="MyBatis built-in"><span class="none"></span>MyBatis built-in</a></li>
    <li><a href="datasources/dbcp.html" title="Apache Commons DBCP"><span class="none"></span>Apache Commons DBCP</a></li>
    <li><a href="datasources/c3p0.html" title="C3P0"><span class="none"></span>C3P0</a></li>
    <li><a href="datasources/hikaricp.html" title="HikariCP"><span class="none"></span>HikariCP</a></li>
    <li><a href="datasources/druid.html" title="Druid"><span class="none"></span>Druid</a></li>
    </ul>
</li>
    <li><a href="injections.html" title="Injections"><span class="none"></span>Injections</a></li>
    <li><a href="transactional.html" title="@Transactional"><span class="none"></span>@Transactional</a></li>
    <li><a href="jta.html" title="JTA"><span class="none"></span>JTA</a></li>
    <li><a href="jdbc-helper.html" title="JDBC Helper"><span class="none"></span>JDBC Helper</a></li>
    <li><a href="samples.html" title="Samples"><span class="none"></span>Samples</a></li>
      <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
</ul>
          <hr />
          <div id="poweredBy">
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span10" >


  
    <div class="section">
<h2><a name="Getting_started"></a>Getting started</h2>
  
<p>
    MyBatis-Guice helps you integrate your MyBatis code seamlessly with
    Google Guice. Using the classes in this library, Google Guice will load
    the necessary MyBatis classes for you. This library also provides
    an easy way to inject MyBatis data mappers and <tt>SqlSessions</tt>
    into your application beans.
    Finally, MyBatis-Guice will let you demarcate transactions declaratively
    so you won't need to commit/rollback/close them by hand.
  </p>
  </div>

  
<div class="section">
<h2><a name="Installation"></a>Installation</h2>
        
<p>
            Installing the mybatis-guice module it is very easy, just put the
            <tt>mybatis-guice-3.12.jar</tt> and
            dependencies in the classpath!
        </p>
        
<p>
            Apache Maven users instead can easily adding the following dependency
            in their POMs :
            </p>
<div class="source"><pre class="prettyprint">&lt;dependencies&gt;
...
  &lt;dependency&gt;
    &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
    &lt;artifactId&gt;mybatis-guice&lt;/artifactId&gt;
    &lt;version&gt;3.12&lt;/version&gt;
  &lt;/dependency&gt;
...
&lt;/dependencies&gt;</pre></div>
        
  </div>

  
<div class="section">
<h2><a name="Quick_Setup"></a>Quick Setup</h2>
    
<p>
      To use MyBatis with Guice you need to set up a <tt>MyBatisModule</tt>,
      with a <tt>DataSource</tt> at least one data mapper class and
      a transactional bean to be injected with the mapper.
    </p>

    
<p>
      To setup a <tt>DataSource</tt> you can simply use the <tt>JdbcHelper</tt> (please see the
      related appendix for more informations) module to build the URL needed for your database and provide the
      connection properties:
      </p>
<div class="source"><pre class="prettyprint">Properties myBatisProperties = new Properties();
myBatisProperties.setProperty(&quot;mybatis.environment.id&quot;, &quot;test&quot;);
myBatisProperties.setProperty(&quot;JDBC.schema&quot;, &quot;mybatis-guice_TEST&quot;);
myBatisProperties.setProperty(&quot;derby.create&quot;, &quot;true&quot;);
myBatisProperties.setProperty(&quot;JDBC.username&quot;, &quot;sa&quot;);
myBatisProperties.setProperty(&quot;JDBC.password&quot;, &quot;&quot;);
myBatisProperties.setProperty(&quot;JDBC.autoCommit&quot;, &quot;false&quot;);

Injector injector = Guice.createInjector(
    JdbcHelper.HSQLDB_Embedded,
    new Module() {
        public void configure(Binder binder) {
            Names.bindProperties(binder, myBatisProperties);
        }
    }
);</pre></div>
   

   
<p>
      Assume you have a data mapper class defined like the following:

      </p>
<div class="source"><pre class="prettyprint">public interface UserMapper {

    @Select(&quot;SELECT * FROM user WHERE id = #{userId}&quot;)
    User getUser(@Param(&quot;userId&quot;) String userId);

}</pre></div>

      Note that the mapper class specified <i>must</i> be an
      interface, not an actual implementation class. In this example,
      annotations are used to specify the SQL, but a MyBatis mapper XML file
      could also be used.
   

   
<p>
      Assume you also have a transactional service bean that uses your mapper:

      </p>
<div class="source"><pre class="prettyprint">public class FooServiceMapperImpl implements FooService {

    @Inject
    private UserMapper userMapper;

    @Transactional
    public User doSomeBusinessStuff(String userId) {
        return this.userMapper.getUser(userId);
    }

}</pre></div>
   

   
<p>
      Setup a <tt>MyBatisModule</tt>, add your mapper to it and bind also 
      your transactional service interface <tt>FooService</tt> to its implementation.
      </p>
<div class="source"><pre class="prettyprint">public interface UserMapper {
...
Injector injector = Guice.createInjector(
    new MyBatisModule() {

        @Override
        protected void initialize() {
            install(JdbcHelper.HSQLDB_Embedded);

            bindDataSourceProviderType(PooledDataSourceProvider.class);
            bindTransactionFactoryType(JdbcTransactionFactory.class);
            addMapperClass(UserMapper.class);

            Names.bindProperties(binder(), createTestProperties());
            bind(FooService.class).to(FooServiceMapperImpl.class);
        }

    }
);</pre></div>
   

    
<p>
       This is all you need, you can now get an instance of your service. It will
       be automatically injected with the MyBatis mapper. With the mapper calling
       MyBatis data methods is only one line of code. Besides, all operations will 
       be transactional, that means that you will not need to commit or rollback 
       any connection. 
      </p>
<div class="source"><pre class="prettyprint">FooService fooService = this.injector.getInstance(FooService.class);
fooService.doSomeBusinessStuff(&quot;data&quot;);</pre></div>
     
  </div>

    


        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2009&#x2013;2020
<a href="http://www.mybatis.org/">MyBatis.org</a>.
All rights reserved.</p>
        </div>
      </div>
    </footer>
  </body>
</html>
